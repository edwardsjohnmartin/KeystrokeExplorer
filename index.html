<!DOCTYPE html>
<html>
  <head>
    <title>Keystroke Explorer</title>
    <link rel="icon" href="./favicon.ico?v=3" />
    <meta name = "description" content = "EdwardsLab" />
    <meta name = "Keywords" content = "Computer, Science, John, Edwards" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="../assets/favicon.ico"/>

    <script src="lib/jquery-3.6.0.min.js"></script>
    <script src="lib/jquery.csv.js"></script>
    
    <script src="lib/papaparse.min.js"></script>
    <!-- <script src="lib/d3.js"></script> -->
    <script src="https://cdn.jsdelivr.net/npm/d3@5"></script>
    <script src="lib/codemirror.js"></script>
    
    <!--script src="lib/filbert.js"></script-->

    <link rel="stylesheet" href="lib/codemirror.css">
    <script src="lib/codemirror/addon/selection/mark-selection.js"></script>
    <script src="lib/codemirror/mode/python/python.js"></script>

    <!--link rel="stylesheet" href="lib/frappe-datatable.css">
    <script src="lib/sortable.js"></script>
    <script src="lib/frappe-datatable.js"></script-->

    <script src="./lib/skulpt.min.js" type="text/javascript"></script>
    <script src="./lib/skulpt-stdlib.js" type="text/javascript"></script>

    <script src="./lib/Brython-3.11.0/brython.js" type="text/javascript"></script>
    <script src="./lib/Brython-3.11.0/brython_stdlib.js" type="text/javascript"></script>

    <script src="./lib/d3_tree.js" type="text/javascript"></script>

    <script src="./lib/saveSvgAsPng.js" type="text/javascript"></script>

    <link rel="stylesheet" href="style.css">
  </head>

  <!-----------------------------------------------------------------------
  <!-- Body --
  <!----------------------------------------------------------------------->
  <body onload="onload(); brython()">
    <main>
      <!-------------- Header -------------->
      <header>
        <div>
          <br>
          ProgSnap2: <input id="ps2-selector" type="file" accept=".csv, .ps2, .log" change="ps2Changed()"></input>
          <br>
          <label for="subjects">SubjectID:</label>
          <select name="subjects" id="subjects" onchange="subjectChanged()"></select>

          <label for="assignments">AssignmentID:</label>
          <select name="assignments" id="assignments" onchange="assignmentChanged()"></select>

          <label for="files">File:</label>
          <select name="files" id="files" onchange="fileChanged()"></select>

          <label for="findString">Search string (use arrows):</label>
          <input name="findString" id="findString" type="text"></input>

          <text id="compileError">Error compiling</text>

          <text id="loading">Loading...</text>

          <br>
          <label for="slider">Playback:</label>
          <input type="range" id="slider" name="slider" min="0" max="10">

          <text id="edit-num"></text>
          <br>
        </div>
      </header>

      <!-------------- Code -------------->
      <code>
        <textarea id="textarea" name="textarea">File text</textarea>
      </code>

      <!-------------- Chart -------------->
      <cpchart>
        <div id="Charts" class="tabcontent_">
          <svg class="chart" id="chart">
            <g id="cpchartgroup">
              <g id="bars"></g>
              <g id="barsstart"></g>
              <g id="barsend"></g>
              <g id="compilable"></g>
              <g id="cpimage"></g>
              <g id="playbarg"></g>
            </g>
          </svg>
        </div>
      </cpchart>
      <tchart>
        <div>
          <br>
          <svg class="chart" id="timelinesvg">
            <g id="timelinechartgroup">
              <g id="timeline"></g>
              <g id="timelineimage"></g>
              <g id="timelineplaybarg"></g>
            </g>
          </svg>
        </div>
      </tchart>

      <!-------------- CSV -------------->
      <csv>
        <div id="grid" class="tabcontent_"></div>


        <div id="Help" class="tabcontent">
          <br>
          Helpful keystrokes:
          <br>f - move forward one event
          <br>d - move backward one event
          <br>F - more forward 10 events
          <br>D - move backward 10 events
          <br>g - move forward to next checkpoint event
          <br>s - move backward to next checkpoint event
          <br>S - move forward to first snapshot containing the search string
          <br>spacebar - replay
          <br>right arrow - next file
          <br>left arrow - previous file
        </div>
      </csv>
      <div id="ast_chart"></div>
    </main>


    <script>
      /*
    <table class="page">
      <tr class="page">
        <td class="page" id="tdcode">
    <!-----------------------------------------------------------------------
    <!-- Code window --
    <!----------------------------------------------------------------------->
    <!--textarea id="textarea" name="textarea">File text</textarea-->
        </td>
        <td class="page" id="tdtabs">
    <!-----------------------------------------------------------------------
    <!-- Tabs --
    <!----------------------------------------------------------------------->
    <!--div class="tab">
      <button class="tablinks" onclick="changeTabs(event, 'Charts')" id="defaultOpen">Charts</button>
      <button class="tablinks" onclick="changeTabs(event, 'grid')">CSV</button>
      <button class="tablinks" onclick="changeTabs(event, 'Help')">Help</button>
    </div-->

    <!-- Tab content -->
    <div id="Charts" class="tabcontent">
      <svg class="chart" id="chart">
        <g id="cpchartgroup">
          <g id="bars"></g>
          <g id="barsstart"></g>
          <g id="barsend"></g>
          <g id="compilable"></g>
          <g id="playbarg"></g>
        </g>
      </svg>
      <br>
      <!--svg class="chart" id="timelinesvg">
        <g id="timelinechartgroup">
          <g id="timeline"></g>
          <g id="timelineplaybarg"></g>
        </g>
      </svg-->
    </div>

    <!--div id="grid" class="tabcontent"></div-->

    <div id="Help" class="tabcontent">
      <br>
      Helpful keystrokes:
      <br>f - move forward one event
      <br>d - move backward one event
      <br>F - more forward 10 events
      <br>D - move backward 10 events
      <br>g - move forward to next checkpoint event
      <br>s - move backward to next checkpoint event
      <br>right arrow - move forward to first snapshot containing the search string
    </div>
    </td>
*/
    </script>
    
    <script src="./main.js?5" onload="brython()"></script>
    <script src="./chart.js?2"></script>
    <script src="./timeline.js?2"></script>
    <script src="./spreadsheet.js?3"></script>
    <script src="./compile.js?3"></script>
    <script type="text/python" src="brython_ast.py"></script>
    <script onload="brython()">
      function get_ast(python_program) {
        console.log('running function get ast')
        ast = brythonListener(python_program)
        parsed_ast = JSON.parse(ast)
        return parsed_ast
      }
      </script>


</body>
</html>
